import{m as $,$ as ve,r as d,j as e,q as $e,Y as je,b as ye}from"./app-B4mvKtWa.js";import{S as ge,t as Pe,a as Ce,b as C,c as Te,d as we,e as T}from"./Icons-BEJmVM2q.js";import{A as Ne}from"./AuthenticatedLayout-DOHighfF.js";import{b as Z}from"./index-DadMTPOu.js";import{b as De}from"./index-Idc6p9wp.js";import{S as U}from"./sweetalert2.all-DTBjZyO6.js";import"./react-webcam-BTuxcaL_.js";import{T as Oe}from"./index-BIX7S6Fa.js";import{$ as Ee,a as _e,T as Ae}from"./useDialog-BfRXoGkA.js";import{$ as Se,a as Re,b as ae,c as A,d as Ie,e as Me,f as ke,g as Le,m as Fe,h as Ge,o as He,i as S,j as Ve,k as Be}from"./chunk-XHQUSKIE-BY2WhD9a.js";import{$ as Ue,p as ee,g as te,t as ze,a as Ke}from"./useMenuTriggerState-nRfGu3D4.js";import{m as We}from"./chunk-CIZQCQPA-CSDkXvCw.js";import{u as Ye}from"./index-YpSDx5PT.js";import{w as qe}from"./chunk-HUKVTWEI-BrLIIGKu.js";import{L as Je,d as Qe,m as Xe,A as Ze}from"./chunk-6NL67ZRH-De-J8ZzD.js";import{i as D}from"./chunk-ZH5EUE66-fkhONWwS.js";import{p as et}from"./chunk-F7XGZDO5-pP4d8ouJ.js";import{m as tt,a as rt,b as ot,c as at}from"./chunk-X4CB5I5S-CnHHtElC.js";import{i as st}from"./chunk-YAC6J4IU-CXt6_GsQ.js";import{m as lt}from"./chunk-QY5NICTW-YqqgwL3k.js";import"./getScrollParent-CrGZdl6f.js";import"./VisuallyHidden-1NrV_rdm.js";import"./LiveAnnouncer-CuNtP5Ew.js";import"./useUpdateEffect-Bz3d4LpN.js";import"./chunk-7F3ZLNJ6-C5eRwpDy.js";import"./chunk-IXXDDLGU-TLu7bgHb.js";import"./ApplicationLogo-DLklyz3G.js";import"./chunk-3XT5V4LF-Cwyux58U.js";import"./chunk-44JHHBS2-D-kVdlHb.js";import"./useControlledState-TOVII5Hj.js";import"./index-Dvs9NgTk.js";import"./iconBase-B7sXqQCO.js";import"./index-CzkkIe6I.js";import"./useField-DZGaZCve.js";import"./index-X92CTFGl.js";const z=$.createContext(null);function nt(t){let{children:a}=t,o=d.useContext(z),[n,f]=d.useState(0),m=d.useMemo(()=>({parent:o,modalCount:n,addModal(){f(s=>s+1),o&&o.addModal()},removeModal(){f(s=>s-1),o&&o.removeModal()}}),[o,n]);return $.createElement(z.Provider,{value:m},a)}function it(){let t=d.useContext(z);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:null}}}function dt(t){let{modalProviderProps:a}=it();return $.createElement("div",{"data-overlay-container":!0,...t,...a})}function ct(t){return $.createElement(nt,null,$.createElement(dt,t))}function re(t){let a=Se(),{portalContainer:o=a?null:document.body,...n}=t;if($.useEffect(()=>{if(o!=null&&o.closest("[data-overlay-container]"))throw new Error("An OverlayContainer must not be inside another container. Please change the portalContainer prop.")},[o]),!o)return null;let f=$.createElement(ct,n);return ve.createPortal(f,o)}const ut=1500,oe=500;let E={},pt=0,M=!1,w=null,_=null;function mt(t={}){let{delay:a=ut,closeDelay:o=oe}=t,{isOpen:n,open:f,close:m}=Ee(t),s=d.useMemo(()=>`${++pt}`,[]),l=d.useRef(),c=()=>{E[s]=y},x=()=>{for(let i in E)i!==s&&(E[i](!0),delete E[i])},u=()=>{clearTimeout(l.current),l.current=null,x(),c(),M=!0,f(),w&&(clearTimeout(w),w=null),_&&(clearTimeout(_),_=null)},y=i=>{i||o<=0?(clearTimeout(l.current),l.current=null,m()):l.current||(l.current=setTimeout(()=>{l.current=null,m()},o)),w&&(clearTimeout(w),w=null),M&&(_&&clearTimeout(_),_=setTimeout(()=>{delete E[s],_=null,M=!1},Math.max(oe,o)))},b=()=>{x(),c(),!n&&!w&&!M?w=setTimeout(()=>{w=null,M=!0,u()},a):n||u()};return d.useEffect(()=>()=>{clearTimeout(l.current),E[s]&&delete E[s]},[s]),{isOpen:n,open:i=>{!i&&a>0&&!l.current?b():u()},close:y}}function ft(t,a){let o=Re(t,{labelable:!0}),{hoverProps:n}=ae({onHoverStart:()=>a==null?void 0:a.open(!0),onHoverEnd:()=>a==null?void 0:a.close()});return{tooltipProps:A(o,n,{role:"tooltip"})}}function xt(t,a,o){let{isDisabled:n,trigger:f}=t,m=Ie(),s=d.useRef(!1),l=d.useRef(!1),c=()=>{(s.current||l.current)&&a.open(l.current)},x=p=>{!s.current&&!l.current&&a.close(p)};d.useEffect(()=>{let p=r=>{o&&o.current&&r.key==="Escape"&&(r.stopPropagation(),a.close(!0))};if(a.isOpen)return document.addEventListener("keydown",p,!0),()=>{document.removeEventListener("keydown",p,!0)}},[o,a]);let u=()=>{f!=="focus"&&(ke()==="pointer"?s.current=!0:s.current=!1,c())},y=()=>{f!=="focus"&&(l.current=!1,s.current=!1,x())},b=()=>{l.current=!1,s.current=!1,x(!0)},i=()=>{Le()&&(l.current=!0,c())},h=()=>{l.current=!1,s.current=!1,x(!0)},{hoverProps:v}=ae({isDisabled:n,onHoverStart:u,onHoverEnd:y}),{focusableProps:N}=Me({isDisabled:n,onFocus:i,onBlur:h},o);return{triggerProps:{"aria-describedby":a.isOpen?m:void 0,...A(N,v,{onPointerDown:b,onKeyDown:b})},tooltipProps:{id:m}}}function ht(t){const[a,o]=Fe(t,ee.variantKeys),{ref:n,as:f,isOpen:m,content:s,children:l,defaultOpen:c,onOpenChange:x,isDisabled:u,trigger:y,shouldFlip:b=!0,containerPadding:i=12,placement:h="top",delay:v=0,closeDelay:N=500,showArrow:p=!1,offset:r=7,crossOffset:j=0,isDismissable:g,shouldCloseOnBlur:le=!0,portalContainer:ne,isKeyboardDismissDisabled:ie=!1,updatePositionDeps:K=[],shouldCloseOnInteractOutside:de,className:ce,onClose:W,motionProps:ue,classNames:R,...B}=a,pe=f||"div",I=mt({delay:v,closeDelay:N,isDisabled:u,defaultOpen:c,isOpen:m,onOpenChange:O=>{x==null||x(O),O||W==null||W()}}),k=d.useRef(null),L=d.useRef(null),F=d.useId(),P=I.isOpen&&!u;d.useImperativeHandle(n,()=>Ge(L));const{triggerProps:Y,tooltipProps:me}=xt({isDisabled:u,trigger:y},I,k),{tooltipProps:q}=ft({isOpen:P,...A(a,me)},I),{overlayProps:J,placement:G,updatePosition:fe}=Ue({isOpen:P,targetRef:k,placement:ze(h),overlayRef:L,offset:p?r+3:r,crossOffset:j,shouldFlip:b,containerPadding:i});Ye(()=>{K.length&&fe()},K);const{overlayProps:Q}=_e({isOpen:P,onClose:I.close,isDismissable:g,shouldCloseOnBlur:le,isKeyboardDismissDisabled:ie,shouldCloseOnInteractOutside:de},L),H=d.useMemo(()=>{var O,V,X;return ee({...o,radius:(O=t==null?void 0:t.radius)!=null?O:"md",size:(V=t==null?void 0:t.size)!=null?V:"md",shadow:(X=t==null?void 0:t.shadow)!=null?X:"sm"})},[He(o),t==null?void 0:t.radius,t==null?void 0:t.size,t==null?void 0:t.shadow]),xe=d.useCallback((O={},V=null)=>({...A(Y,O),ref:We(V,k),"aria-describedby":P?F:void 0}),[Y,P,F,I]),he=d.useCallback(()=>({ref:L,"data-slot":"base","data-open":S(P),"data-arrow":S(p),"data-disabled":S(u),"data-placement":te(G,h),...A(q,Q,B),style:A(J.style,B.style,a.style),className:H.base({class:R==null?void 0:R.base}),id:F}),[H,P,p,u,G,h,q,Q,B,J,a,F]),be=d.useCallback(()=>({"data-slot":"content","data-open":S(P),"data-arrow":S(p),"data-disabled":S(u),"data-placement":te(G,h),className:H.content({class:Ve(R==null?void 0:R.content,ce)})}),[H,P,p,u,G,h,R]);return{Component:pe,content:s,children:l,isOpen:P,triggerRef:k,showArrow:p,portalContainer:ne,placement:h,disableAnimation:t==null?void 0:t.disableAnimation,isDisabled:u,motionProps:ue,getTooltipContentProps:be,getTriggerProps:xe,getTooltipProps:he}}var se=Be((t,a)=>{const{Component:o,children:n,content:f,isOpen:m,portalContainer:s,placement:l,disableAnimation:c,motionProps:x,getTriggerProps:u,getTooltipProps:y,getTooltipContentProps:b}=ht({...t,ref:a});let i;try{if(d.Children.count(n)!==1)throw new Error;if(!d.isValidElement(n))i=e.jsx("p",{...u(),children:n});else{const g=n;i=d.cloneElement(g,u(g.props,g.ref))}}catch{i=e.jsx("span",{}),qe("Tooltip must have only one child node. Please, check your code.")}const{ref:h,id:v,style:N,...p}=y(),r=e.jsx("div",{ref:h,id:v,style:N,children:e.jsx(Je,{features:Qe,children:e.jsx(Xe.div,{animate:"enter",exit:"exit",initial:"exit",variants:Ae.scaleSpring,...A(x,p),style:{...Ke(l)},children:e.jsx(o,{...b(),children:f})})})});return e.jsxs(e.Fragment,{children:[i,c&&m?e.jsx(re,{portalContainer:s,children:e.jsx("div",{ref:h,id:v,style:N,...p,children:e.jsx(o,{...b(),children:f})})}):e.jsx(Ze,{children:m?e.jsx(re,{portalContainer:s,children:r}):null})]})});se.displayName="NextUI.Tooltip";var bt=se;function Zt({auth:t}){const{props:{guests:a}}=$e(),[o,n]=$.useState(""),m=a.slice().sort((r,j)=>r.name.localeCompare(j.name)).filter(r=>r.name.toLowerCase().includes(o.toLowerCase())),[s,l]=$.useState(!1),[c,x]=$.useState(null),u=async()=>{if(m.length===0){U.fire({icon:"warning",title:"No Records",text:"There are no guests to export."});return}try{const r=await ye.get("/generate-report",{responseType:"blob"}),j=window.URL.createObjectURL(new Blob([r.data])),g=document.createElement("a");g.href=j,g.setAttribute("download","Guests_Report.pdf"),document.body.appendChild(g),g.click(),U.fire({icon:"success",title:"PDF Report Generated",text:"The PDF report has been successfully generated and downloaded."})}catch(r){console.error("Error generating PDF report:",r),U.fire({icon:"error",title:"Error",text:"Failed to generate PDF report. Please try again later."})}},y=r=>{x(r),l(!0)},b=()=>{l(!1)},[i,h]=$.useState(1),v=10,N=Math.ceil(m.length/v),p=$.useMemo(()=>{const r=(i-1)*v,j=r+v;return m.slice(r,j)},[i,v,m]);return e.jsxs(Ne,{user:t.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Registered Guests"}),children:[e.jsx(je,{title:"Guests"}),e.jsx("div",{className:"py-8 p-2",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex justify-between gap-3 items-end mb-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(Z,{color:"secondary",variant:"flat",onClick:u,className:"mt-6",startContent:e.jsx(De,{}),children:"Export to PDF"})}),e.jsx(D,{variant:"bordered",value:o,onChange:r=>n(r.target.value),placeholder:"Search by name",className:"w-full sm:max-w-[35%]",startContent:e.jsx(ge,{className:"text-black/50 mb-0.5 dark:text-white/90 text-slate-400 pointer-events-none flex-shrink-0"})})]})}),e.jsxs(Pe,{"aria-label":"Guests Table",bottomContent:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(et,{isCompact:!0,showControls:!0,showShadow:!0,color:"secondary",page:i,total:N,onChange:r=>h(r)})}),classNames:{wrapper:"min-h-[222px]"},children:[e.jsxs(Ce,{children:[e.jsx(C,{className:"text-success",children:"#"}),e.jsx(C,{children:"NAME"}),e.jsx(C,{children:"EMAIL"}),e.jsx(C,{children:"PHONE"}),e.jsx(C,{children:"ID TYPE"}),e.jsx(C,{children:"ID NUMBER"}),e.jsx(C,{children:"COMPANY"}),e.jsx(C,{children:"ADDRESS"}),e.jsx(C,{children:"DATE CREATED"}),e.jsx(C,{children:"ACTION"})]}),e.jsx(Te,{emptyContent:"No guests found",items:p,children:p.map((r,j)=>e.jsxs(we,{children:[e.jsx(T,{className:"text-success",children:(i-1)*v+j+1}),e.jsx(T,{children:r.name}),e.jsx(T,{children:r.email}),e.jsx(T,{children:r.phone}),e.jsx(T,{children:r.id_type}),e.jsx(T,{children:r.id_number}),e.jsx(T,{children:r.company}),e.jsx(T,{children:r.address}),e.jsx(T,{children:new Date(r.created_at).toLocaleString([],{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})}),e.jsx(T,{children:e.jsx("div",{className:"flex justify-center text-xl cursor-pointer active:opacity-50",children:e.jsx(bt,{showArrow:!0,color:"primary",content:"View",children:e.jsx("span",{className:"text-primary cursor-pointer active:opacity-50",onClick:()=>y(r),children:e.jsx(Oe,{className:"text-primary"})})})})})]},r.id))})]})]})}),e.jsx(tt,{isDismissable:!1,isOpen:s,onOpenChange:b,hideCloseButton:!0,backdrop:"blur",scrollBehavior:"inside",children:e.jsx(rt,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"flex flex-col gap-1",children:"Guest Details"}),e.jsx(at,{children:c&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(D,{label:"Guest Name",variant:"bordered",value:c.name??"No name provided"}),e.jsx(D,{label:"Email",variant:"bordered",value:c.email??"No email provided"}),e.jsx(D,{label:"Phone",variant:"bordered",value:c.phone??"No phone provided"}),e.jsx(D,{label:"ID Type",variant:"bordered",value:c.id_type??"No ID provided"}),e.jsx(D,{label:"ID Number",variant:"bordered",value:c.id_number??"No ID number provided"}),e.jsx(D,{label:"Company",variant:"bordered",value:c.company??"No company provided"}),e.jsx(D,{label:"Address",variant:"bordered",value:c.address??"No address provided"}),e.jsx("hr",{className:"my-3"}),e.jsx("p",{children:"Guest Photo"}),e.jsx(st,{src:c.photo,alt:"Guest Photo",fallbackSrc:"https://via.placeholder.com/300x200"})]})}),e.jsx(lt,{children:e.jsx(Z,{color:"danger",onPress:b,children:"Close"})})]})})})]})}export{Zt as default};
